#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

log() {
    echo "-----> $*"
}

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3
DPKG_DIR=$BUILD_DIR/.dpkg
DPKG_CACHE_DIR=$CACHE_DIR/dpkg/cache
XRAY_DOWNLOAD_LINK="https://s3.dualstack.us-east-2.amazonaws.com/aws-xray-assets.us-east-2/xray-daemon/aws-xray-daemon-linux-2.x.zip"

mkdir -p $CACHE_DIR

log "Downloading X-Ray daemon..."
wget -nc $XRAY_DOWNLOAD_LINK -P $CACHE_DIR

log "Extracting X-Ray daemon executable..."
cd $CACHE_DIR
jar xf *.zip
